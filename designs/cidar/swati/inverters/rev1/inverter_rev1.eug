//Properties
Property Name(txt);
Property ID(txt);
Property Sequence(txt);
Property Represses(txt);
Property RepressedBy(txt);
Property InducedBy(txt);
Property Description (txt);
Property Induces(txt);
Property Strength(num); /** num ==1 for strongest RBS; num ==5 for weakest RBS **/

Property Pigeon(txt);

//Part Types
PartType IndPr (Name, Sequence, InducedBy, Pigeon);
PartType RepPr (Name, Sequence, RepressedBy, Pigeon);
PartType ConstPr (Name, Sequence, Pigeon);
PartType RBS (Name, Sequence, Strength, Pigeon);
PartType Repressor (Name, Sequence, Represses, Pigeon);
PartType Reporter (Name, Sequence, Description, Pigeon);
PartType Inducer (Name, Sequence, Induces, Pigeon);
PartType Terminator (Name, Sequence, Pigeon);
PartType SmallMolecule (Name, Pigeon);


/* fusion sites -> NOT NEEDED FOR NOW
PartType FusionSite(Name, Sequence);
FusionSite A(.Name("A"), .Sequence("GGAG"));
FusionSite B(.Name("B"), .Sequence("TACT"));
FusionSite C(.Name("C"), .Sequence("AATG"));
FusionSite D(.Name("D"), .Sequence("AGGT"));
FusionSite E(.Name("E"), .Sequence("GCTT"));
FusionSite F(.Name("F"), .Sequence("CGCT"));
FusionSite G(.Name("G"), .Sequence("TGCC"));
FusionSite H(.Name("H"), .Sequence("GGAG"));
 */
 
ConstPr J23100(
	.Name("J23100"), 
	.Sequence("TTGACGGCTAGCTCAGTCCTAGGTACAGTGCTAGC"), 
	.Pigeon("p J23100"));
RepPr R0040(
	.Name("R0040"), 
	.Sequence("TCCCTATCAGTGATAGAGATTGACATCCCTATCAGTGATAGAGATACTGAGCAC"),
	.RepressedBy("C0040"),
	.Pigeon("p R0040 5"));
RepPr R0051 (
	.Name("R0051"),
	.Sequence("taacaccgtgcgtgttgactattttacctctggcggtgataatggttgc"),
	.RepressedBy("C0051"),
	.Pigeon("p R0051 7"));

RBS B0030m(.Name("B0030m"), 
	.Sequence("AGAGATTAAAGAGGAGAAATACTA"), 
	.Strength(2), 
	.Pigeon("r B0030m"));
RBS B0031m(
	.Name("B0031m"), 
	.Sequence("AGAGTCACACAGGAAACCT"), 
	.Strength(4), 
	.Pigeon("r B0031m"));
RBS B0032m(
	.Name("B0032m"), 
	.Sequence("AGAGTCACACAGGAAAGTACTA"), 
	.Strength(3), 
	.Pigeon("r B0032m"));
/**	
RBS B0033m(
	.Name("B0033m"), 
	.Sequence("AGAGTCACACAGGACTACTA"), 
	.Strength(5), 
	.Pigeon("r B0033m"));
RBS B0034m1(
	.Name("B0034m1"), 
	.Sequence("AGAGAAAGAGGAGAAATACTA"), 
	.Strength(1), 
	.Pigeon("r B0034m_BC"));
 **/ 
Repressor C0040(
	.Name("C0040"), 
	.Sequence("ATGTCCAGATTAGATAAAAGTAAAGTGATTAACAGCGCATT
AGAGCTGCTTAATGAGGTCGGAATCGAAGGTTTAACAACCCGTAAACTCGCCCAGAAGCTAGGTGTAGAGCAGCCTA
CATTGTATTGGCATGTAAAAAATAAGCGGGCTTTGCTCGACGCCTTAGCCATTGAGATGTTAGATAGGCACCATACT
CACTTTTGCCCTTTAGAAGGGGAAAGCTGGCAAGATTTTTTACGTAATAACGCTAAAAGTTTTAGATGTGCTTTACT
AAGTCATCGCGATGGAGCAAAAGTACATTTAGGTACACGGCCTACAGAAAAACAGTATGAAACTCTCGAAAATCAAT
TAGCCTTTTTATGCCAACAAGGTTTTTCACTAGAGAATGCATTATATGCACTCAGCGCTGTGGGGCATTTTACTTTA
GGTTGCGTATTGGAAGATCAAGAGCATCAAGTCGCTAAAGAAGAAAGGGAAACACCTACTACTGATAGTATGCCGCC
ATTATTACGACAAGCTATCGAATTATTTGATCACCAAGGTGCAGAGCCAGCCTTCTTATTCGGCCTTGAATTGATCA
TATGCGGATTAGAAAAACAACTTAAATGTGAAAGTGGGTCCGCTGCAAACGACGAAAACTACGCTTTAGTAGCTTAA
TAACACTGATAGTGCTAGTGTAGATCAC"),
	.Represses("R0040"),
	.Pigeon("c C0040 5"));
	
/**
Repressor C0012(
	.Name("C0012"), 
	.Sequence("ATGGTGAATGTGAAACCAGTAACGTTATACGATGTCGCAGAGTAT
GCCGGTGTCTCTTATCAGACCGTTTCCCGCGTGGTGAACCAGGCCAGCCACGTTTCTGCGAAAACGCGGGAAAAAGTGGAA
GCGGCGATGGCGGAGCTGAATTACATTCCCAACCGCGTGGCACAACAACTGGCGGGCAAACAGTCGTTGCTGATTGGCGTT
GCCACCTCCAGTCTGGCCCTGCACGCGCCGTCGCAAATTGTCGCGGCGATTAAATCTCGCGCCGATCAACTGGGTGCCAGC
GTGGTGGTGTCGATGGTAGAACGAAGCGGCGTCGAAGCCTGTAAAGCGGCGGTGCACAATCTTCTCGCGCAACGCGTCAGT
GGGCTGATCATTAACTATCCGCTGGATGACCAGGATGCCATTGCTGTGGAAGCTGCCTGCACTAATGTTCCGGCGTTATTT
CTTGATGTCTCTGACCAGACACCCATCAACAGTATTATTTTCTCCCATGAAGACGGTACGCGACTGGGCGTGGAGCATCTG
GTCGCATTGGGTCACCAGCAAATCGCGCTGTTAGCGGGCCCATTAAGTTCTGTCTCGGCGCGTCTGCGTCTGGCTGGCTGG
CATAAATATCTCACTCGCAATCAAATTCAGCCGATAGCGGAACGGGAAGGCGACTGGAGTGCCATGTCCGGTTTTCAACAA
ACCATGCAAATGCTGAATGAGGGCATCGTTCCCACTGCGATGCTGGTTGCCAACGATCAGATGGCGCTGGGCGCAATGCGC
GCCATTACCGAGTCCGGGCTGCGCGTTGGTGCGGATATCTCGGTAGTGGGATACGACGATACCGAAGACAGCTCATGTTAT
ATCCCGCCGTTAACCACCATCAAACAGGATTTTCGCCTGCTGGGGCAAACCAGCGTGGACCGCTTGCTGCAACTCTCTCAG
GGCCAGGCGGTGAAGGGCAATCAGCTGTTGCCCGTCTCACTGGTGAAAAGAAAAACCACCCTGGCGCCCAATACGCAAACC
GCCTCTCCCCGCGCGTTGGCCGATTCATTAATGCAGCTGGCACGACAGGTTTCCCGACTGGAAAGCGGGCAGGCTGCAAAC
GACGAAAACTACGCTTTAGTAGCTTAATAACTCTGATAGTGCTAGTGTAGATCTC"), 
	.Represses("K091112"),
	.Pigeon("c C0012 5"));

Repressor C0080(
	.Name("C0080"), 
	.Sequence("ATGGCTGAAGCGCAAAATGATCCCCTGCTGCCGGGATACTCGT
TTAACGCCCATCTGGTGGCGGGTTTAACGCCGATTGAGGCCAATGGTTATCTCGATTTTTTTATCGACCGACCGCTGGGA
ATGAAAGGTTATATTCTCAATCTCACCATTCGCGGTCAGGGGGTGGTGAAAAATCAGGGACGAGAATTTGTCTGCCGACC
GGGTGATATTTTGCTGTTCCCGCCAGGAGAGATTCATCACTACGGTCGTCATCCGGAGGCTCGCGAATGGTATCACCAGT
GGGTTTACTTTCGTCCGCGCGCCTACTGGCATGAATGGCTTAACTGGCCGTCAATATTTGCCAATACGGGTTTCTTTCGC
CCGGATGAAGCGCACCAGCCGCATTTCAGCGACCTGTTTGGGCAAATCATTAACGCCGGGCAAGGGGAAGGGCGCTATTC
GGAGCTGCTGGCGATAAATCTGCTTGAGCAATTGTTACTGCGGCGCATGGAAGCGATTAACGAGTCGCTCCATCCACCGA
TGGATAATCGGGTACGCGAGGCTTGTCAGTACATCAGCGATCACCTGGCAGACAGCAATTTTGATATCGCCAGCGTCGCA
CAGCATGTTTGCCTGTCGCCGTCGCGTCTGTCACATCTTTTCCGCCAGCAGTTAGGGATTAGCGTCTTAAGCTGGCGCGAG
GACCAACGCATCAGCCAGGCGAAGCTGCTTTTGAGCACTACCCGGATGCCTATCGCCACCGTCGGTCGCAATGTTGGTTTT
GACGATCAACTCTATTTCTCGCGAGTATTTAAAAAATGCACCGGGGCCAGCCCGAGCGAGTTCCGTGCCGGTTGTGAAGAA
AAAGTGAATGATGTAGCCGTCAAGTTGTCAGCTGCAAACGACGAAAACTACGCTTTAGTAGCTTAATAA"), 
	.Represses("I13453"),
	.Pigeon("c C0080 7"));
**/

Repressor C0051(
	.Name("C0051"), 
	.Sequence("ATGAGCACAAAAAAGAAACCATTAACACAAGAGCAGCTTGA
GGACGCACGTCGCCTTAAAGCAATTTATGAAAAAAAGAAAAATGAACTTGGCTTATCCCAGGAATCTGTCGCAGACA
AGATGGGGATGGGGCAGTCAGGCGTTGGTGCTTTATTTAATGGCATCAATGCATTAAATGCTTATAACGCCGCATTG
CTTGCAAAAATTCTCAAAGTTAGCGTTGAAGAATTTAGCCCTTCAATCGCCAGAGAAATCTACGAGATGTATGAAGC
GGTTAGTATGCAGCCGTCACTTAGAAGTGAGTATGAGTACCCTGTTTTTTCTCATGTTCAGGCAGGGATGTTCTCAC
CTGAGCTTAGAACCTTTACCAAAGGTGATGCGGAGAGATGGGTAAGCACAACCAAAAAAGCCAGTGATTCTGCATTC
TGGCTTGAGGTTGAAGGTAATTCCATGACCGCACCAACAGGCTCCAAGCCAAGCTTTCCTGACGGAATGTTAATTCT
CGTTGACCCTGAGCAGGCTGTTGAGCCAGGTGATTTCTGCATAGCCAGACTTGGGGGTGATGAGTTTACCTTCAAGA
AACTGATCAGGGATAGCGGTCAGGTGTTTTTACAACCACTAAACCCACAGTACCCAATGATCCCATGCAATGAGAGT
TGTTCCGTTGTGGGGAAAGTTATCGCTAGTCAGTGGCCTGAAGAGACGTTTGGCGCTGCAAACGACGAAAACTACGC
TTTAGTAGCTTAATAACGCTGATAGTGCTAGTGTAGATCGC"),
	.Represses("R0051"),
	.Pigeon("c C0051 7"));

/*** 
Inducer C0062(
	.Name("C0062"), 
	.Sequence("atgaaaaacataaatgccgacgacacatacagaataattaata
aaattaaagcttgtagaagcaataatgatattaatcaatgcttatctgatatgactaaaatggtacattgtgaatat
tatttactcgcgatcatttatcctcattctatggttaaatctgatatttcaatcctagataattaccctaaaaaatg
gaggcaatattatgatgacgctaatttaataaaatatgatcctatagtagattattctaactccaatcattcaccaa
ttaattggaatatatttgaaaacaatgctgtaaataaaaaatctccaaatgtaattaaagaagcgaaaacatcaggt
cttatcactgggtttagtttccctattcatacggctaacaatggcttcggaatgcttagttttgcacattcagaaaa
agacaactatatagatagtttatttttacatgcgtgtatgaacataccattaattgttccttctctagttgataatt
atcgaaaaataaatatagcaaataataaatcaaacaacgatttaaccaaaagagaaaaagaatgtttagcgtgggca
tgcgaaggaaaaagctcttgggatatttcaaaaatattaggttgcagtgagcgtactgtcactttccatttaaccaa
tgcgcaaatgaaactcaatacaacaaaccgctgccaaagtatttctaaagcaattttaacaggagcaattgattgcc
catactttaaaaattaataa"),
	.Induces("R0062"));
**/

Reporter E1010m(
	.Name("E1010m"), 
	.Sequence("AATGATGGCTTCCTCCGAGGATGTTATCAAAGAGTTCATG
CGTTTCAAAGTTCGTATGGAAGGTTCCGTTAACGGTCACGAGTTCGAAATCGAAGGTGAAGGTGAAGGTCGTCCGTA
CGAAGGTACCCAGACCGCTAAACTGAAAGTTACCAAAGGTGGTCCGCTGCCGTTCGCTTGGGACATCCTGTCCCCGC
AGTTCCAGTACGGTTCCAAAGCTTACGTTAAACACCCGGCTGACATCCCGGACTACCTGAAACTGTCCTTCCCGGAA
GGTTTCAAATGGGAACGTGTTATGAACTTCGAAGATGGTGGTGTTGTTACCGTTACCCAGGACTCCTCCCTGCAAGA
CGGTGAGTTCATCTACAAAGTTAAACTGCGTGGTACCAACTTCCCGTCCGACGGTCCGGTTATGCAGAAAAAAACCA
TGGGTTGGGAAGCTTCCACCGAACGTATGTACCCGGAGGATGGTGCTCTGAAAGGTGAAATCAAAATGCGTCTGAAA
CTGAAAGACGGTGGTCACTACGACGCTGAAGTTAAAACCACCTACATGGCTAAAAAACCGGTTCAGCTGCCGGGTGC
TTACAAAACCGACATCAAACTGGACATCACCTCCCACAACGAGGACTACACCATCGTTGAACAGTACGAACGTGCTG
AAGGTCGTCACTCCACCGGTGCTTAATAA"),
	.Description("RFP"),
	.Pigeon("c E1010 6"));

Reporter E0040(
	.Name("E0040"), 
	.Sequence("ATGCGTAAAGGAGAAGAACTTTTCACTGGAGTTGTCCCAATT
CTTGTTGAATTAGATGGTGATGTTAATGGGCACAAATTTTCTGTCAGTGGAGAGGGTGAAGGTGATGCAACATACGG
AAAACTTACCCTTAAATTTATTTGCACTACTGGAAAACTACCTGTTCCATGGCCAACACTTGTCACTACTTTCGGTT
ATGGTGTTCAATGCTTTGCGAGATACCCAGATCATATGAAACAGCATGACTTTTTCAAGAGTGCCATGCCCGAAGGT
TATGTACAGGAAAGAACTATATTTTTCAAAGATGACGGGAACTACAAGACACGTGCTGAAGTCAAGTTTGAAGGTGA
TACCCTTGTTAATAGAATCGAGTTAAAAGGTATTGATTTTAAAGAAGATGGAAACATTCTTGGACACAAATTGGAAT
ACAACTATAACTCACACAATGTATACATCATGGCAGACAAACAAAAGAATGGAATCAAAGTTAACTTCAAAATTAGA
CACAACATTGAAGATGGAAGCGTTCAACTAGCAGACCATTATCAACAAAATACTCCAATTGGCGATGGCCCTGTCCT
TTTACCAGACAACCATTACCTGTCCACACAATCTGCCCTTTCGAAAGATCCCAACGAAAAGAGAGACCACATGGTCC
TTCTTGAGTTTGTAACAGCTGCTGGGATTACACATGGCATGGATGAACTATACAAATAATAA"),
	.Description("GFP"),
	.Pigeon("c E0040 4"));

Terminator B0015(
	.Name("B0015"), 
	.Sequence("CCAGGCATCAAATAAAACGAAAGGCTCAGTCGAAAGACTG
GGCCTTTCGTTTTATCTGTTGTTTGTCGGTGAACGCTCTCTACTAGAGTCACACTGGCTCACCTTCGGGTGGGCCTT
TCTGCGTTTATA"),
	.Pigeon("t B0015"));


//Intermediate Devices (Transcriptional Units)
Device Inverter = 
	ConstPr + RBS + Repressor + B0015 +
	RepPr + RBS + Repressor + B0015 + 
	RepPr + RBS + Reporter + B0015 +
	RepPr + RBS + Reporter + B0015;

Rule rTmp (
	ON Inverter:
	 		// Represses relationships
			Inverter[2].Represses EQUALS Inverter[4].Name 
				AND
        	Inverter[2].Represses EQUALS Inverter[8].Name 
        		AND
			Inverter[6].Represses EQUALS Inverter[12].Name 
		
		AND
		
			// equal RBS in TU2 and TU3
			Inverter[5] EQUALS Inverter[9] 
		
		AND
		
			// GFP and RFP ??
			E0040 WITH E1010m 
				AND
			E0040 AFTER E1010m
		 
		AND
			// RBS order ?? 
			B0030m WITH B0031m AND B0031m WITH B0032m
				AND
			B0030m BEFORE B0031m AND B0031m BEFORE B0032m

		AND 
		
			// different Repressors
			Inverter[2] NOTEQUALS Inverter[6]
		
);

function toPigeon(Device d) {
    num n = 1;
	for(num i=0; i<d.size(); i++) {
		println(d[i].Pigeon);
		if(n == 4) {
		   println(".");
		   n = 1;
		} else {
		   n++;
		}		
		
	}
	println("# Arcs");
	for (num i=0; i<d.size(); i++) {
	    if(d[i] INSTANCEOF Repressor) {
	        println(d[i].Name, " rep ", d[i].Represses);
	    }
	}
}

Device[] lst = product(Inverter, strict);

println(lst.size(), " inverters were generated...");
//toPigeon(lst[0]);

/**
for(num k=0; k<lst.size(); k++) {
    println("**** ", lst[k].Name," ****");
    toPigeon(lst[k]);
}
**/
//save(lst);  // save the generated inverters for further processing

