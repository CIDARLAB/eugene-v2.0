//PART PROPERTIES
Property Name(txt);
Property Sequence(txt);
Property Pigeon(txt);

Part Promoter(Name, Sequence, Pigeon);
Part RBS(Name, Sequence, Pigeon);
Part InvertaseSite(Name, Sequence, Pigeon);
Part Gene(Name, Sequence, Pigeon);
Part Reporter(Name, Sequence, Pigeon);
Part Terminator(Name, Sequence, Pigeon);

/*** PROMOTERS ***/
Promoter proA(
	.Name("proA"), 
	.Sequence("CACAGCTAACACCACGTCGTCCCTATCTGCTGCCCTAGGTCTATGAGTGGTTGCTGGATAACTTTACGGGCATGCATAAGGCTCGTAGGCTATATTCAGGGAGACCACAACGGTTTCCCTCTACAAATAATTTTGTTTAACTTT"), 
	.Pigeon("p proA 4"));

Promoter proC(
	.Name("proC"), 
	.Sequence("CACAGCTAACACCACGTCGTCCCTATCTGCTGCCCTAGGTCTATGAGTGGTTGCTGGATAACTTTACGGGCATGCATAAGGCTCGTATGATATATTCAGGGAGACCACAACGGTTTCCCTCTACAAATAATTTTGTTTAACTTT"), 
	.Pigeon("p proB 4"));

Promoter proD(
	.Name("proD"), 
	.Sequence("CACAGCTAACACCACGTCGTCCCTATCTGCTGCCCTAGGTCTATGAGTGGTTGCTGGATAACTTTACGGGCATGCATAAGGCTCGTATAATATATTCAGGGAGACCACAACGGTTTCCCTCTACAAATAATTTTGTTTAACTTT"),
	.Pigeon("p proD 4"));

/*** INVERTASE SITES ***/
InvertaseSite Bxb1_attB(
	.Name("Bxb1_attB"), 
	.Sequence("TCGGCCGGCTTGTCGACGACGGCGGTCTCCGTCGTCAGGATCATCCGGGC"),
	.Pigeon("> Bxb1_B 2"));
	
InvertaseSite Bxb1_attP(
	.Name("Bxb1_attP"), 
	.Sequence("GTCGTGGTTTGTCTGGTCAACCACCGCGGTCTCAGTGGTGTACGGTACAAACCCCGAC"),
	.Pigeon("> Bxb1_P 2"));
 	
InvertaseSite phiC31_attB(
	.Name("phiC31_attB"), 
	.Sequence("TGCGGGTGCCAGGGCGTGCCCTTGGGCTCCCCGGGCGCGTACTCC"),
	.Pigeon("> C31_B 13"));

InvertaseSite phiC31_attP(
	.Name("phiC31_attP"), 
	.Sequence("GTGCCCCAACTGGGGTAACCTTTGAGTTCTCTCAGTTGGGGG"),
	.Pigeon("> C31_P 13"));

/** Relationships between invertase sites **/
Bxb1_attB MATCHES Bxb1_attP;
phiC31_attP MATCHES phiC31_attB;


/*** RBSs ***/	
RBS rbs1(
	.Name("rbs1"), 
	.Sequence("GTGTGGCCGTCG"),
	.Pigeon("r rbs1 13"));
RBS rbs2(
	.Name("rbs2"), 
	.Sequence("GTGTGGCCGTCG"),
	.Pigeon("r rbs2 13"));
RBS rbs3(
	.Name("rbs3"), 
	.Sequence("GTGTGGCCGTCG"),
	.Pigeon("r rbs3 13"));
	
/*** GENEs ***/
Gene phiC31(
	.Name("phiC31"), 
	.Sequence("ATGACACAAGGGGTTGTGACCGGGGTGGACACGTACGCGGGTGCTTACGACCGTCAGTCGCGCGAGCGCGAGAATTCGAGCGCAGCAAGCCCAGTCCGCACCTGGGCAGCACGAAGGCACGTGCAACGTCAGCATGGCGGCACTCGACAAGTTCGTTGCGGAACGCATCTTCAACAAGATCAGGCACGCCGAAGGCGACGAAGAGACGTTGGCGCTTCTGTGGGAAGCCGCCCGACGCTTCGGCAAGCTCACTGAGGCGCCTGAGAAGAGCGGCGAACGGGCGAACCTTGTTGCGGAGCGCGCCGACGCCCTGAACGCCCTTGAAGAGCTGTACGAAGACCGCGCGGCAGGCGCGTACGACGGACCCGTTGGCAGGAAGCACTTCCGGAAGCAACAGGCAGCGCTGACGCTCCGGCAGCAAGGGGCGGAAGAGCGGCTTGCCGAACTTGAAGCCGCCGAAGCCCCGAAGCTTCCCCTTGACCAATGGTTCCCCGAAGACGCCGACGCTGACCCGACCGGCCCTAAGTCGTGGTGGGGGCGCGCGTCAGTAGACGACAAGCGCGTGTTCGTCGGGCTCTTCGTAGACAAGATCGTTGTCACGAAGTCGACTACGGGCAGGGGGCAGGGAACGCCCATCGAGAAGCGCGCTTCGATCACGTGGGCGAAGCCGCCGACCGACGACGACGAAGACGACGCCCAGGACGGCACGGAAGACGTAGCGGCGTAGCGACACAGCGTAGCGCCAACGAAGACAAGGCGGCCGACCTTCAGCGCGAAGTCGAGCGCGACGGGGGCCGGTTCAGGTTCGTCGGGCATTTCAGCGAAGCGCCGGGCACGTCGGCGTTCGGGACGGCGGAGCGCCCGGAGTTCGAACGCATCCTGAACGAATGCCGCGCCGGGCGGCTCAACATGATCATTGTCTATGACGTGTCGCGCTTCTCGCGCCTGAAGGTCATGGACGCGATTCCGATTGTCTCGGAATTGCTCGCCCTGGGCGTGACGATTGTTTCCACTCAGGAAGGCGTCTTCCGGCAGGGAAACGTCATGGACCTGATTCACCTGATTATGCGGCTCGACGCGTCGCACAAAGAATCTTCGCTGAAGTCGGCGAAGATTCTCGACACGAAGAACCTTCAGCGCGAATTGGGCGGGTACGTCGGCGGGAAGGCGCCTTACGGCTTCGAGCTTGTTTCGGAGACGAAGGAGATCACGCGCAACGGCCGAATGGTCAATGTCGTCATCAACAAGCTTGCGCACTCGACCACTCCCCTTACCGGACCCTTCGAGTTCGAGCCCGACGTAATCCGGTGGTGGTGGCGTGAGATCAAGACGCACAAACACCTTCCCTTCAAGCCGGGCAGTCAAGCCGCCATTCACCCGGGCAGCATCACGGGGCTTTGTAAGCGCATGGACGCTGACGCCGTGCCGACCCGGGGCGAGACGATTGGGAAGAAGACCGCTTCAAGCGCCTGGGACCCGGCAACCGTTATGCGAATCCTTCGGGACCCGCGTATTGCGGGCTTCGCCGCTGAGGTGATCTACAAGAAGAAGCCGGACGGCACGCCGACCACGAAGATTGAGGGTTACCGCATTCAGCGCGACCCGATCACGCTCCGGCCGGTCGAGCTTGATTGCGGACCGATCATCGAGCCCGCTGAGTGGTATGAGCTTCAGGCGTGGTTGGACGGCAGGGGGCGCGGCAAGGGGCTTTCCCGGGGGCAAGCCATTCTGTCCGCCATGGACAAGCTGTACTGCGAGTGTGGCGCCGTCATGACTTCGAAGCGCGGGGAAGAATCGATCAAGGACTCTTACCGCTGCCGTCGCCGGAAGGTGGTCGACCCG"), 
	.Pigeon("c C31"));
	
Gene Bxb1(
	.Name("Bxb1"), 
	.Sequence("ATGAGAGCCCTGGTAGTCATCCGCCTGTCCCGCGTCACCGATGCTACGACTTCACCGGAGCGTCAGCTGGAGTCTTGCCAGCAGCTCTGCGCCCAGGGCTCGGCAGCGTGGTCGAACGGCTACACACCGGGATGTCGTAGCGCGGCTGGGACGTCGTCGGGGTAGCGGAGGATCTGGACGTCTCCGGGGCGGTCGATCCGTTCGACCGGAAGCGCAGACCGAACCTGGCCCGGTGGCTAGCGTTCGAGGAGCAACCGTTCGACGTGATCGTGGCGTACCGGGTAGACCGGTTGACCCGATCGATCCGGCATCTGCAGCAGCTGGTCCACTGGGCCGAGGACCACAAGAAGCTGGTCGTCTCCGCGACCGAAGCGCACTTCGATACGACGACGCCGTTTGCGGCGGTCGTCATCGCGCTTATGGGAACGGTGGCGCAGATGGAATTAGAAGCGATCAAAGAGCGGAACCGTTCGGCTGCGCATTTCAATATCCGCGCCGGGAAATACCGAGGATCCCTGCCGCCGTGGGGATACCTGCCTACGCGCGTGGACGGGGAGTGGCGGCTGGTGCCGGACCCTGTGCAGCGAGAGCGCATCCTCGAGGTGTATCACCGCGTCGTCGACAACCACGAGCCGCTGCACCTGGTGGCCCACGACCTGAACCGGCGTGGTGTCCTGTCGCCGAAGGACTACTTCGCGCAGCTGCAAGGCCGCGAGCCGCAGGGCCGGGAGTGGTCGGCTACCGCGCTGAAGCGATCGATGATCTCCGAGGCGATGCTCGGGTACGCGACTCTGAACGGTAAGACCGTCCGAGACGACGACGGAGCCCCGCTGGTGCGGGCTGAGCCGATCCTGACCCGTGAGCAGCTGGAGGCGCTGCGCGCCGAGCTCGTGAAGACCTCCCGGGCGAAGCCCGCGGTGTCTACCCCGTCGCTGCTGCTGCGGGTGTTGTTCTGCGCGGTGTGCGGGGAGCCCGCGTACAAGTTCGCCGGGGGAGGACGTAAGCACCCGCGCTACCGCTGCCGCTCGATGGGGTTCCCGAAGCACTGCGGGAACGGCACGGTGGCGATGGCCGAGTGGGACGCGTTCTGCGAGGAGCAGGTGCTGGATCTGCTCGGGGACGCGGAGCGTCTGGAGAAAGTCTGGGTAGCCGGCTCGGACTCCGCGGTCGAACTCGCGGAGGTGAACGCGGAGCTGGTGGACCTGACGTCGCTGATCGGCTCCCCGGCCTACCGGGCCGGCTCTCCGCAGCGAGAAGCACTGGATGCCCGTATTGCGGCGCTGGCCGCGCGGCAAGAGGAGCTGGAGGGTCTAGAGGCTCGCCCGTCTGGCTGGGAGTGGCGCGAGACCGGGCAGCGGTTCGGGGACTGGTGGCGGGAGCAGGACACCGCGGCAAAGAACACCTGGCTTCGGTCGATGAACGTTCGGCTGACGTTCGACGTCCGCGGCGGGCTGACTCGCACGATCGACTTCGGGGATCTGCAGGAGTACGAGCAGCATCTCA"), 
	.Pigeon("c Bxb1"));


/*** REPORTERS ***/	
Reporter gfp(
	.Name("gfp"), 
	.Sequence("ATGCGTAAAGGAGAAGAACTTTTCACTGGAGTTGTCCCAATTCTTGTTGAATTAGATGGTGATGTTAATGGGCACAAATTTTCTGTCAGTGGAGAGGGTGAAGGTGATGCAACATACGGAAAACTTACCCTTAAATTTATTTGCACTACTGGAAAACTACCTGTTCCATGGCCAACACTTGTCACTACTTTCGGTTATGGTGTTCAATGCTTTGCGAGATACCCAGATCATATGAAACAGCATGACTTTTTCAAGAGTGCCATGCCCGAAGGTTATGTACAGGAAAGAACTATATTTTTCAAAGATGACGGGAACTACAAGACACGTGCTGAAGTCAAGTTTGAAGGTGATACCCTTGTTAATAGAATCGAGTTAAAAGGTATTGATTTTAAAGAAGATGGAAACATTCTTGGACACAAATTGGAATACAACTATAACTCACACAATGTATACATCATGGCAGACAAACAAAAGAATGGAATCAAAGTTAACTTCAAAATTAGACACAACATTGAAGATGGAAGCGTTCAACTAGCAGACCATTATCAACAAAATACTCCAATTGGCGATGGCCCTGTCCTTTTACCAGACAACCATTACCTGTCCACACAATCTGCCCTTTCGAAAGATCCCAACGAAAAGAGAGACCACATGGTCCTTCTTGAGTTTGTAACAGCTGCTGGGATTACACATGGCATGGATGAACTATACAAATAA"),
	.Pigeon("c GFP 12"));


/*** TERMINATORS ***/
Terminator T1(
	.Name("T1"), 
	.Sequence("GGCATCAAATAAAACGAAAGGCTCAGTCGAAAGACTGGGCCTTTCGTTTTATCTGTTGTTTGTCGGTGAACGCTCTCCTGAGTAGGACAAATCCGCCGCCCTAGA"),
	.Pigeon("t T1 8"));
Terminator T2(
	.Name("T2"), 
	.Sequence("GGCATCAAATAAAACGAAAGGCTCAGTCGAAAGACTGGGCCTTTCGTTTTATCTGTTGTTTGTCGGTGAACGCTCTCCTGAGTAGGACAAATCCGCCGCCCTAGA"),
	.Pigeon("t T2 10"));
Terminator T3(
	.Name("T3"), 
	.Sequence("GGCATCAAATAAAACGAAAGGCTCAGTCGAAAGACTGGGCCTTTCGTTTTATCTGTTGTTTGTCGGTGAACGCTCTCCTGAGTAGGACAAATCCGCCGCCCTAGA"),
	.Pigeon("t T3 12"));
Terminator T4(
	.Name("T4"), 
	.Sequence("GGCATCAAATAAAACGAAAGGCTCAGTCGAAAGACTGGGCCTTTCGTTTTATCTGTTGTTTGTCGGTGAACGCTCTCCTGAGTAGGACAAATCCGCCGCCCTAGA"),
	.Pigeon("t T4 6"));



/* This is the published NOR gate...
 * Device NOR_gate(proD, Bxb1_attB, -T1, -Bxb1_attP, phiC31_attP, -T1, -phiC31_attB, rbs, gfp, T1);
 */
// Q: can we define any rules that produce the published NOR gate?
Device NorGate(
	Promoter, InvertaseSite, -Terminator, -InvertaseSite, InvertaseSite, -Terminator, -InvertaseSite, RBS, Reporter, Terminator);

Rule r1(
	ON NorGate:
		NorGate[1] MATCHES NorGate[3]
			AND
		NorGate[4] MATCHES NorGate[6]
				
			AND
		
		Bxb1_attB WITH phiC31_attB
);

// finally, let's do some product
Device[] lst = product(NorGate, strict, 1000);
println("*** INVERTASE NOR GATES ***");
println(lst);
	